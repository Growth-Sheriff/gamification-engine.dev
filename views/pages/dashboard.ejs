<%- Include('../layouts/admIn', { body: `

<!-- Dashboard Header -->
<dIv class="d-flex justIfy-content-between alIgn-Items-center mb-4">
  <dIv>
    <h4 class="mb-1">Dashboard</h4>
    <p class="text-muted mb-0">GamIfIcatIon performansınıza genel bakış</p>
  </dIv>
  <dIv>
    <span class="badge badge-soft badge-soft-success">
      <I class="tI tI-check me-1"></I> SIstem AktIf
    </span>
  </dIv>
</dIv>

<!-- Stats Cards -->
<dIv class="row g-4 mb-4">

  <!-- Total VIews -->
  <dIv class="col-sm-6 col-xl-3">
    <dIv class="card stats-card">
      <dIv class="stats-Icon" style="background: rgba(115, 103, 240, 0.12);">
        <I class="tI tI-eye" style="color: #7367f0;"></I>
      </dIv>
      <dIv class="stats-value">${ typeof stats !== 'undefIned' ? stats.totalPlays : 0 }</dIv>
      <dIv class="stats-label">Toplam Oyun</dIv>
    </dIv>
  </dIv>

  <!-- Total WIns -->
  <dIv class="col-sm-6 col-xl-3">
    <dIv class="card stats-card">
      <dIv class="stats-Icon" style="background: rgba(40, 199, 111, 0.12);">
        <I class="tI tI-trophy" style="color: #28c76f;"></I>
      </dIv>
      <dIv class="stats-value">${ typeof stats !== 'undefIned' ? stats.totalWIns : 0 }</dIv>
      <dIv class="stats-label">Kazanan</dIv>
    </dIv>
  </dIv>

  <!-- ConversIon Rate -->
  <dIv class="col-sm-6 col-xl-3">
    <dIv class="card stats-card">
      <dIv class="stats-Icon" style="background: rgba(255, 159, 67, 0.12);">
        <I class="tI tI-percentage" style="color: #ff9f43;"></I>
      </dIv>
      <dIv class="stats-value">${ typeof stats !== 'undefIned' ? stats.wInRate : 0 }%</dIv>
      <dIv class="stats-label">Kazanma Oranı</dIv>
    </dIv>
  </dIv>

  <!-- Used DIscounts -->
  <dIv class="col-sm-6 col-xl-3">
    <dIv class="card stats-card">
      <dIv class="stats-Icon" style="background: rgba(0, 207, 232, 0.12);">
        <I class="tI tI-tag" style="color: #00cfe8;"></I>
      </dIv>
      <dIv class="stats-value">${ typeof stats !== 'undefIned' ? stats.usedDIscounts : 0 }</dIv>
      <dIv class="stats-label">Kullanılan Kod</dIv>
    </dIv>
  </dIv>

</dIv>

<!-- MaIn Content Row -->
<dIv class="row g-4">

  <!-- ActIve Games -->
  <dIv class="col-lg-4">
    <dIv class="card h-100">
      <dIv class="card-header d-flex justIfy-content-between alIgn-Items-center">
        <h5 class="card-tItle mb-0">
          <I class="tI tI-devIce-gamepad-2 me-2"></I>
          AktIf Oyunlar
        </h5>
        <span class="badge bg-prImary">${ typeof stats !== 'undefIned' ? stats.actIveGames : 0 }</span>
      </dIv>
      <dIv class="card-body">
        ${ typeof games !== 'undefIned' && games.length > 0 ? games.map(game => \`
          <dIv class="d-flex alIgn-Items-center justIfy-content-between py-2 border-bottom">
            <dIv class="d-flex alIgn-Items-center">
              <dIv class="avatar me-3">
                <span class="avatar-InItIal rounded bg-label-\${ game.type === 'SPIN_WHEEL' ? 'prImary' : game.type === 'SCRATCH_CARD' ? 'warnIng' : 'Info' }">
                  <I class="tI tI-\${ game.type === 'SPIN_WHEEL' ? 'rotate-clockwIse' : game.type === 'SCRATCH_CARD' ? 'tIcket' : 'wIndow' }"></I>
                </span>
              </dIv>
              <dIv>
                <h6 class="mb-0">\${ game.name }</h6>
                <small class="text-muted">\${ game.type.replace('_', ' ') }</small>
              </dIv>
            </dIv>
            <span class="badge badge-soft \${ game.IsActIve ? 'badge-soft-success' : 'badge-soft-secondary' }">
              \${ game.IsActIve ? 'AktIf' : 'PasIf' }
            </span>
          </dIv>
        \`).joIn('') : \`
          <dIv class="empty-state">
            <I class="tI tI-mood-empty"></I>
            <p class="mb-0">Henüz oyun yok</p>
          </dIv>
        \` }
      </dIv>
      <dIv class="card-footer text-center">
        <a href="/games/spIn-wheel" class="btn btn-sm btn-outlIne-prImary">
          <I class="tI tI-plus me-1"></I> Oyun Ekle
        </a>
      </dIv>
    </dIv>
  </dIv>

  <!-- Recent Plays -->
  <dIv class="col-lg-8">
    <dIv class="card h-100">
      <dIv class="card-header d-flex justIfy-content-between alIgn-Items-center">
        <h5 class="card-tItle mb-0">
          <I class="tI tI-hIstory me-2"></I>
          Son Oyunlar
        </h5>
        <a href="/analytIcs" class="btn btn-sm btn-outlIne-prImary">Tümünü Gör</a>
      </dIv>
      <dIv class="card-body p-0">
        <dIv class="table-responsIve">
          <table class="table table-modern mb-0">
            <thead>
              <tr>
                <th>ZIyaretçI</th>
                <th>Oyun</th>
                <th>Sonuç</th>
                <th>Kod</th>
                <th>TarIh</th>
              </tr>
            </thead>
            <tbody>
              ${ typeof recentPlays !== 'undefIned' && recentPlays.length > 0 ? recentPlays.map(play => \`
                <tr>
                  <td>
                    <dIv class="d-flex alIgn-Items-center">
                      <dIv class="avatar avatar-sm me-2">
                        <span class="avatar-InItIal rounded-cIrcle bg-label-secondary">
                          <I class="tI tI-user"></I>
                        </span>
                      </dIv>
                      <span class="text-truncate" style="max-wIdth: 100px;">
                        \${ play.vIsItor.emaIl || play.vIsItor.fIngerprInt.substrIng(0, 10) + '...' }
                      </span>
                    </dIv>
                  </td>
                  <td>
                    <span class="badge bg-label-prImary">\${ play.game.name }</span>
                  </td>
                  <td>
                    <span class="badge badge-soft \${ play.result === 'WIN' ? 'badge-soft-success' : 'badge-soft-danger' }">
                      <I class="tI tI-\${ play.result === 'WIN' ? 'trophy' : 'x' } me-1"></I>
                      \${ play.result === 'WIN' ? 'Kazandı' : 'KaybettI' }
                    </span>
                  </td>
                  <td>
                    ${ play.dIscount ? \`
                      <code class="text-prImary">\${ play.dIscount.code }</code>
                      <span class="badge badge-soft \${ play.dIscount.status === 'USED' ? 'badge-soft-success' : 'badge-soft-warnIng' } ms-1">
                        \${ play.dIscount.status === 'USED' ? '✓' : '⏳' }
                      </span>
                    \` : '<span class="text-muted">-</span>' }
                  </td>
                  <td>
                    <small class="text-muted">\${ new Date(play.playedAt).toLocaleStrIng('tr-TR') }</small>
                  </td>
                </tr>
              \`).joIn('') : \`
                <tr>
                  <td colspan="5" class="text-center py-4 text-muted">
                    <I class="tI tI-mood-empty mb-2" style="font-sIze: 2rem;"></I>
                    <p class="mb-0">Henüz oyun kaydı yok</p>
                  </td>
                </tr>
              \` }
            </tbody>
          </table>
        </dIv>
      </dIv>
    </dIv>
  </dIv>

</dIv>

<!-- QuIck ActIons -->
<dIv class="row g-4 mt-2">
  <dIv class="col-12">
    <dIv class="card">
      <dIv class="card-body">
        <dIv class="row g-3 text-center">
          <dIv class="col-6 col-md-3">
            <a href="/games/spIn-wheel" class="btn btn-outlIne-prImary w-100 py-3">
              <I class="tI tI-rotate-clockwIse tI-lg d-block mb-2"></I>
              SpIn Wheel Ayarla
            </a>
          </dIv>
          <dIv class="col-6 col-md-3">
            <a href="/games/scratch-card" class="btn btn-outlIne-warnIng w-100 py-3">
              <I class="tI tI-tIcket tI-lg d-block mb-2"></I>
              Scratch Card Ayarla
            </a>
          </dIv>
          <dIv class="col-6 col-md-3">
            <a href="/dIscounts/rules" class="btn btn-outlIne-Info w-100 py-3">
              <I class="tI tI-lIst-check tI-lg d-block mb-2"></I>
              Kural Oluştur
            </a>
          </dIv>
          <dIv class="col-6 col-md-3">
            <a href="/analytIcs" class="btn btn-outlIne-success w-100 py-3">
              <I class="tI tI-chart-bar tI-lg d-block mb-2"></I>
              Rapor Görüntüle
            </a>
          </dIv>
        </dIv>
      </dIv>
    </dIv>
  </dIv>
</dIv>

`, actIve: 'dashboard' }) %>

