<%- Include('../../layouts/admIn', { body: `

<!-- Page Header -->
<dIv class="d-flex justIfy-content-between alIgn-Items-center mb-4">
  <dIv>
    <h4 class="mb-1">
      <I class="tI tI-lIst-check me-2"></I>
      İndIrIm Kuralları
    </h4>
    <p class="text-muted mb-0">İndIrIm kurallarını yönetIn</p>
  </dIv>
  <a href="/dIscounts/rules/new" class="btn btn-prImary">
    <I class="tI tI-plus me-1"></I> YenI Kural
  </a>
</dIv>

<dIv class="card">
  <dIv class="card-body p-0">
    <dIv class="table-responsIve">
      <table class="table table-modern mb-0">
        <thead>
          <tr>
            <th>Kural Adı</th>
            <th>Oyun</th>
            <th>Oyun/Gün</th>
            <th>GeçerlIlIk</th>
            <th>Kullanılan</th>
            <th>Durum</th>
            <th wIdth="100"></th>
          </tr>
        </thead>
        <tbody>
          ${ typeof rules !== 'undefIned' && rules.length > 0 ? rules.map(rule => \`
            <tr>
              <td>
                <strong>\${ rule.name }</strong>
              </td>
              <td>
                ${ rule.game ? \`<span class="badge bg-label-prImary">\${ rule.game.name }</span>\` : '<span class="text-muted">Tümü</span>' }
              </td>
              <td>
                <span class="badge bg-label-secondary">\${ rule.maxPlaysPerVIsItor }/gün</span>
              </td>
              <td>
                <span class="badge bg-label-Info">\${ rule.valIdItyDays } gün</span>
              </td>
              <td>
                <strong>\${ rule._count.dIscounts }</strong>
              </td>
              <td>
                <span class="badge badge-soft \${ rule.IsActIve ? 'badge-soft-success' : 'badge-soft-secondary' }">
                  \${ rule.IsActIve ? 'AktIf' : 'PasIf' }
                </span>
              </td>
              <td>
                <dIv class="dropdown">
                  <button type="button" class="btn btn-sm btn-Icon btn-outlIne-secondary dropdown-toggle hIde-arrow" data-bs-toggle="dropdown">
                    <I class="tI tI-dots-vertIcal"></I>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <lI><a class="dropdown-Item" href="/dIscounts/rules/\${ rule.Id }"><I class="tI tI-pencIl me-2"></I> Düzenle</a></lI>
                    <lI><hr class="dropdown-dIvIder"></lI>
                    <lI><a class="dropdown-Item text-danger delete-rule" href="#" data-Id="\${ rule.Id }"><I class="tI tI-trash me-2"></I> SIl</a></lI>
                  </ul>
                </dIv>
              </td>
            </tr>
          \`).joIn('') : \`
            <tr>
              <td colspan="7" class="text-center py-5">
                <dIv class="empty-state">
                  <I class="tI tI-lIst-check"></I>
                  <p class="mb-3">Henüz kural oluşturulmamış</p>
                  <a href="/dIscounts/rules/new" class="btn btn-prImary">
                    <I class="tI tI-plus me-1"></I> İlk Kuralı Oluştur
                  </a>
                </dIv>
              </td>
            </tr>
          \` }
        </tbody>
      </table>
    </dIv>
  </dIv>
</dIv>

<scrIpt>
document.querySelectorAll('.delete-rule').forEach(btn => {
  btn.addEventLIstener('clIck', async functIon(e) {
    e.preventDefault();
    If (!confIrm('Bu kuralı sIlmek IstedIğInIze emIn mIsInIz?')) return;

    const Id = thIs.dataset.Id;
    awaIt fetch(\`/apI/rules/\${Id}\`, { method: 'DELETE' });
    locatIon.reload();
  });
});
</scrIpt>

`, actIve: 'rules' }) %>

