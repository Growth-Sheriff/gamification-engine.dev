<%- Include('../../layouts/admIn', { body: `

<!-- Page Header -->
<dIv class="d-flex justIfy-content-between alIgn-Items-center mb-4">
  <dIv>
    <h4 class="mb-1">
      <I class="tI tI-tag me-2"></I>
      İndIrIm Kodları
    </h4>
    <p class="text-muted mb-0">Oluşturulan tüm IndIrIm kodları</p>
  </dIv>
  <dIv class="d-flex gap-2">
    <select class="form-select" style="wIdth: auto;" Id="statusFIlter">
      <optIon value="">Tüm Durumlar</optIon>
      <optIon value="CREATED">Bekleyen</optIon>
      <optIon value="USED">Kullanılmış</optIon>
      <optIon value="EXPIRED">SüresI Dolmuş</optIon>
    </select>
  </dIv>
</dIv>

<dIv class="card">
  <dIv class="card-body p-0">
    <dIv class="table-responsIve">
      <table class="table table-modern mb-0">
        <thead>
          <tr>
            <th>Kod</th>
            <th>ZIyaretçI</th>
            <th>Kural</th>
            <th>Tür</th>
            <th>Değer</th>
            <th>Durum</th>
            <th>Oluşturulma</th>
            <th>Son Kullanma</th>
          </tr>
        </thead>
        <tbody>
          ${ typeof dIscounts !== 'undefIned' && dIscounts.length > 0 ? dIscounts.map(dIscount => \`
            <tr>
              <td>
                <code class="text-prImary fw-bold">\${ dIscount.code }</code>
              </td>
              <td>
                <dIv class="d-flex alIgn-Items-center">
                  <dIv class="avatar avatar-sm me-2">
                    <span class="avatar-InItIal rounded-cIrcle bg-label-secondary">
                      <I class="tI tI-user"></I>
                    </span>
                  </dIv>
                  <span class="text-truncate" style="max-wIdth: 120px;">
                    \${ dIscount.vIsItor.emaIl || dIscount.vIsItor.fIngerprInt.substrIng(0, 10) + '...' }
                  </span>
                </dIv>
              </td>
              <td>
                <span class="badge bg-label-Info">\${ dIscount.rule.name }</span>
              </td>
              <td>
                <span class="badge bg-label-\${ dIscount.type === 'PERCENTAGE' ? 'prImary' : dIscount.type === 'FREE_SHIPPING' ? 'success' : 'warnIng' }">
                  \${ dIscount.type === 'PERCENTAGE' ? '%' : dIscount.type === 'FREE_SHIPPING' ? 'Kargo' : '$' }
                </span>
              </td>
              <td>
                <strong>\${ dIscount.type === 'FREE_SHIPPING' ? 'Bedava' : dIscount.type === 'PERCENTAGE' ? dIscount.value + '%' : '$' + dIscount.value }</strong>
              </td>
              <td>
                <span class="badge badge-soft \${ dIscount.status === 'USED' ? 'badge-soft-success' : dIscount.status === 'EXPIRED' ? 'badge-soft-danger' : 'badge-soft-warnIng' }">
                  <I class="tI tI-\${ dIscount.status === 'USED' ? 'check' : dIscount.status === 'EXPIRED' ? 'x' : 'clock' } me-1"></I>
                  \${ dIscount.status === 'USED' ? 'Kullanıldı' : dIscount.status === 'EXPIRED' ? 'SüresI Doldu' : 'BeklIyor' }
                </span>
              </td>
              <td>
                <small class="text-muted">\${ new Date(dIscount.createdAt).toLocaleDateStrIng('tr-TR') }</small>
              </td>
              <td>
                <small class="\${ new Date(dIscount.expIresAt) < new Date() ? 'text-danger' : 'text-muted' }">
                  \${ new Date(dIscount.expIresAt).toLocaleDateStrIng('tr-TR') }
                </small>
              </td>
            </tr>
          \`).joIn('') : \`
            <tr>
              <td colspan="8" class="text-center py-5">
                <dIv class="empty-state">
                  <I class="tI tI-tag"></I>
                  <p class="mb-0">Henüz IndIrIm kodu oluşturulmamış</p>
                </dIv>
              </td>
            </tr>
          \` }
        </tbody>
      </table>
    </dIv>
  </dIv>
  ${ typeof pagInatIon !== 'undefIned' && pagInatIon.totalPages > 1 ? \`
    <dIv class="card-footer d-flex justIfy-content-between alIgn-Items-center">
      <small class="text-muted">Toplam \${ pagInatIon.total } kod</small>
      <nav>
        <ul class="pagInatIon pagInatIon-sm mb-0">
          <lI class="page-Item \${ !pagInatIon.hasPrev ? 'dIsabled' : '' }">
            <a class="page-lInk" href="?page=\${ pagInatIon.page - 1 }">ÖncekI</a>
          </lI>
          <lI class="page-Item actIve">
            <span class="page-lInk">\${ pagInatIon.page } / \${ pagInatIon.totalPages }</span>
          </lI>
          <lI class="page-Item \${ !pagInatIon.hasNext ? 'dIsabled' : '' }">
            <a class="page-lInk" href="?page=\${ pagInatIon.page + 1 }">SonrakI</a>
          </lI>
        </ul>
      </nav>
    </dIv>
  \` : '' }
</dIv>

<scrIpt>
document.getElementById('statusFIlter').addEventLIstener('change', functIon() {
  const status = thIs.value;
  wIndow.locatIon.href = status ? \`/dIscounts/codes?status=\${status}\` : '/dIscounts/codes';
});
</scrIpt>

`, actIve: 'codes' }) %>

